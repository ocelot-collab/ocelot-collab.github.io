"use strict";(self.webpackChunkocelot_website=self.webpackChunkocelot_website||[]).push([[8293],{5599:(s,e,a)=>{a.r(e),a.d(e,{assets:()=>r,contentTitle:()=>c,default:()=>d,frontMatter:()=>t,metadata:()=>n,toc:()=>m});const n=JSON.parse('{"id":"tutorial/tutorial-beam-dynamics/tracking","title":"2. Tracking","description":"This notebook was created by Sergey Tomin (sergey.tomin@desy.de). Source and license info is on GitHub. January 2018.","source":"@site/docs/tutorial/tutorial-beam-dynamics/2_tracking.md","sourceDirName":"tutorial/tutorial-beam-dynamics","slug":"/tutorial/tutorial-beam-dynamics/tracking","permalink":"/docs/tutorial/tutorial-beam-dynamics/tracking","draft":false,"unlisted":false,"editUrl":"https://github.com/ocelot-collab/ocelot-collab.github.io/tree/main/docs/tutorial/tutorial-beam-dynamics/2_tracking.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"2. Tracking"},"sidebar":"tutorialSidebar","previous":{"title":"1. Linear Optics. DBA","permalink":"/docs/tutorial/tutorial-beam-dynamics/dba"},"next":{"title":"3. Space Charge","permalink":"/docs/tutorial/tutorial-beam-dynamics/space_charge"}}');var i=a(4848),l=a(8453);const t={sidebar_position:2,title:"2. Tracking"},c="Tracking",r={},m=[{value:"This example will cover the following topics:",id:"this-example-will-cover-the-following-topics",level:5},{value:"Coordinates",id:"coordinates",level:4},{value:"Definitions",id:"definitions",level:3},{value:"Requirements",id:"requirements",level:4},{value:"1. Design optics calculation for the EuXFEL Injector",id:"1-design-optics-calculation-for-the-euxfel-injector",level:2},{value:"2. Tracking in First and Second Order Approximation (No Collective Effects)",id:"2-tracking-in-first-and-second-order-approximation-no-collective-effects",level:2},{value:"Loading the Beam Distribution",id:"loading-the-beam-distribution",level:3},{value:"Defining the Lattice and Tracking Order",id:"defining-the-lattice-and-tracking-order",level:3},{value:"Tracking",id:"tracking-1",level:2},{value:"<code>Navigator</code>",id:"navigator",level:3},{value:"<code>track()</code> function",id:"track-function",level:3},{value:"Tracking with Beam Matching",id:"tracking-with-beam-matching",level:4},{value:"Example",id:"example",level:3},{value:"Beam distribution",id:"beam-distribution",level:4},{value:"Explicit usage of matplotlib functions",id:"explicit-usage-of-matplotlib-functions",level:3},{value:"Current profile",id:"current-profile",level:4}];function h(s){const e={a:"a",admonition:"admonition",annotation:"annotation",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mspace:"mspace",msub:"msub",msup:"msup",p:"p",pre:"pre",semantics:"semantics",span:"span",ul:"ul",...(0,l.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("small",{children:(0,i.jsxs)(e.p,{children:["This notebook was created by Sergey Tomin (",(0,i.jsx)(e.a,{href:"mailto:sergey.tomin@desy.de",children:"sergey.tomin@desy.de"}),"). Source and license info is on ",(0,i.jsx)(e.a,{href:"https://github.com/ocelot-collab/ocelot",children:"GitHub"}),". January 2018."]})}),"\n",(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"tracking",children:(0,i.jsx)(e.a,{href:"https://github.com/ocelot-collab/ocelot/blob/dev/demos/ipython_tutorials/2_tracking.ipynb",children:"Tracking"})})}),"\n",(0,i.jsx)(e.p,{children:"As an example, we will use lattice file (converted to Ocelot format) of the European XFEL Injector."}),"\n",(0,i.jsx)(e.h5,{id:"this-example-will-cover-the-following-topics",children:"This example will cover the following topics:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"calculation of the linear optics for the European XFEL Injector."}),"\n",(0,i.jsx)(e.li,{children:"Tracking of the particles in first and second order approximation without collective effects."}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"coordinates",children:"Coordinates"}),"\n",(0,i.jsx)(e.p,{children:"Coordinates in Ocelot are following:"}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mspace,{width:"1em"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"x"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mn,{children:"0"})]})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mspace,{width:"2em"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mspace,{width:"1em"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"y"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mn,{children:"0"})]})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mspace,{width:"2em"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsx)(e.mi,{children:"\u03c4"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mspace,{width:"1em"}),(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(e.mi,{children:"E"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mn,{children:"0"})]}),(0,i.jsx)(e.mi,{children:"c"})]})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\left (x, \\quad x' = \\frac{p_x}{p_0} \\right), \\qquad \\left (y, \\quad y' = \\frac{p_y}{p_0} \\right), \\qquad \\left (\\tau = c\\Delta t, \\quad p = \\frac{\\Delta E}{p_0 c} \\right)"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.4em",verticalAlign:"-0.95em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"1em"}}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8019em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.1076em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8804em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"2em"}}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"1em"}}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8019em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.1076em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8804em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"2em"}}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"c"}),(0,i.jsx)(e.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"1em"}}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"c"})]})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8804em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]})]})})]})}),"\n",(0,i.jsx)(e.h3,{id:"definitions",children:"Definitions"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"\u03c4"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"\u03b2"}),(0,i.jsx)(e.mn,{children:"0"})]})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\tau = c t - \\frac{s}{\\beta_0}"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6984em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"c"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.1765em",verticalAlign:"-0.4811em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6954em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05278em"},children:"\u03b2"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3173em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.357em",marginLeft:"-0.0528em",marginRight:"0.0714em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.143em"},children:(0,i.jsx)(e.span,{})})})]})})]})})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"s"})})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.4811em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]}),": Longitudinal coordinate of the particle."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"s"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"s"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"})]})})]}),": Independent variable representing the distance along the beam line (equivalent to the path length of the reference particle)."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"v"}),(0,i.jsx)(e.mn,{children:"0"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"v_0"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," and ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mn,{children:"0"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"p_0"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),": Velocity and momentum of the reference particle, respectively."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"t"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"t"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6151em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})})]}),": Time at which a particle reaches position ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"s"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"s"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"})]})})]})," along the beam line."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(e.mi,{children:"E"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"E"}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"E"}),(0,i.jsx)(e.mn,{children:"0"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Delta E = E - E_0"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0576em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]}),", where ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"E"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"\u03b3"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mn,{children:"0"})]}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mn,{children:"2"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"E = \\gamma m_0 c^2"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0085em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05556em"},children:"\u03b3"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"c"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]})]})]})]})," is the total energy of the particle."]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["See more in ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/coordinate_system",children:"Ocelot Coordinate System"})]}),"\n",(0,i.jsx)(e.h4,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"injector_lattice.py - input file, the Injector lattice."}),"\n",(0,i.jsxs)(e.li,{children:["beam_130MeV.ast    - input file, initial beam distribution in ",(0,i.jsx)(e.a,{href:"http://www.desy.de/~mpyflo/",children:"ASTRA"})," format."]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# the output of plotting commands is displayed inline within frontends, \n# directly below the code cell that produced it\n%matplotlib inline\n\n# this python library provides generic shallow (copy) and \n# deep copy (deepcopy) operations \nfrom copy import deepcopy\n\nimport time\n\n# import from Ocelot main modules and functions\nfrom ocelot import *\n\n# import from Ocelot graphical modules\nfrom ocelot.gui.accelerator import *\n\n# import injector lattice\nfrom injector_lattice import *\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"    initializing ocelot...\n"})}),"\n",(0,i.jsx)(e.p,{children:"If you want to see injector_lattice.py file you can run following command (lattice file is very large):"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"$ %load injector_lattice.py\n"})}),"\n",(0,i.jsxs)(e.p,{children:["The variable ",(0,i.jsx)(e.em,{children:"cell"})," contains all the elements of the lattice in right order."]}),"\n",(0,i.jsxs)(e.p,{children:["And again Ocelot will work with class ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/magnet-lattice",children:"MagneticLattice"})," instead of simple sequence of element. So we have to run following command."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"lat = MagneticLattice(cell, stop=None)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"1-design-optics-calculation-for-the-euxfel-injector",children:"1. Design optics calculation for the EuXFEL Injector"}),"\n",(0,i.jsxs)(e.p,{children:["For linear accelerators, the initial ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/twiss",children:"Twiss"})," parameters and initial beam energy must be defined to compute the optics."]}),"\n",(0,i.jsxs)(e.p,{children:["To calculate Twiss paramters along the beamline ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/twiss",children:(0,i.jsx)(e.code,{children:"twiss"})})," is used"]}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsxs)(e.p,{children:["In the low-energy part of the accelerator, ",(0,i.jsx)(e.a,{href:"/docs/docu/physics-processes/sc",children:"space charge"})," effect can significantly influence the beam dynamics. For simplicity, this tutorial does not consider any collective effects."]})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# initialization of Twiss object\ntws0 = Twiss()\n# defining initial twiss parameters\ntws0.beta_x = 29.171\ntws0.beta_y = 29.171\ntws0.alpha_x = 10.955\ntws0.alpha_y = 10.955\n# defining initial electron energy in GeV\ntws0.E = 0.005 \n\n# calculate optical functions with initial twiss parameters\ntws = twiss(lat, tws0)\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'# ploting twiss paramentrs.\nplot_opt_func(lat, tws, top_plot=["Dx", "Dy"], fig_name="i1", legend=False)\nplt.show()\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"png",src:a(7157).A+"",width:"635",height:"487"})}),"\n",(0,i.jsx)(e.h2,{id:"2-tracking-in-first-and-second-order-approximation-no-collective-effects",children:"2. Tracking in First and Second Order Approximation (No Collective Effects)"}),"\n",(0,i.jsxs)(e.p,{children:["In this section, we track a beam distribution generated by ASTRA, taken at the position 3.2 meters downstream from the gun cathode.\nThat is why, we need to start the Ocelot simulation from the same longitudinal position by setting the start argument of the ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/magnet-lattice",children:"MagneticLattice"})," object to the corresponding element in the beamline."]}),"\n",(0,i.jsx)(e.h3,{id:"loading-the-beam-distribution",children:"Loading the Beam Distribution"}),"\n",(0,i.jsxs)(e.p,{children:["To load a particle distribution, use the function ",(0,i.jsx)(e.code,{children:"load_particle_array(FILENAME)"}),".",(0,i.jsx)(e.br,{}),"\n","Ocelot currently supports the following formats:"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"ASTRA"}),"\n",(0,i.jsx)(e.li,{children:"CSRtrack"}),"\n",(0,i.jsxs)(e.li,{children:["Ocelot (",(0,i.jsx)(e.code,{children:".npz"}),")"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"If you already used:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from ocelot import *\n"})}),"\n",(0,i.jsx)(e.p,{children:"you don\u2019t need to import anything else. Otherwise, you can directly import the loader:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from ocelot.cpbd.io import load_particle_array\n"})}),"\n",(0,i.jsxs)(e.p,{children:["This function returns a ",(0,i.jsx)(e.code,{children:"ParticleArray"})," \u2014 Ocelot\u2019s standard object for representing particle distributions.\nMore details can be found in the ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/particle-array",children:"ParticleArray documentation"}),"."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'#from ocelot.cpbd.io import load_particle_array\n\np_array_init = load_particle_array("sc_beam.npz")\n'})}),"\n",(0,i.jsx)(e.h3,{id:"defining-the-lattice-and-tracking-order",children:"Defining the Lattice and Tracking Order"}),"\n",(0,i.jsx)(e.p,{children:"To configure the beamline and select the tracking method, use the MagneticLattice class:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"MagneticLattice(sequence, start=None, stop=None, method={})\n"})}),"\n",(0,i.jsx)(e.p,{children:"Arguments:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"sequence: list of lattice elements"}),"\n",(0,i.jsx)(e.li,{children:"start: first element where tracking should begin"}),"\n",(0,i.jsx)(e.li,{children:"stop: last element (optional)"}),"\n",(0,i.jsx)(e.li,{children:"method: dictionary to assign transfer maps globally or per element"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Example:\n",(0,i.jsx)(e.code,{children:'method = {"global": SecondTM}'})]}),"\n",(0,i.jsx)(e.p,{children:"Predefined transfer maps include:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"TransferMap: first-order matrix"}),"\n",(0,i.jsx)(e.li,{children:"SecondTM: second-order matrix"}),"\n",(0,i.jsx)(e.li,{children:"KickTM: single-kick tracking"}),"\n",(0,i.jsx)(e.li,{children:"RungeKuttaTM: numerical integration using element.mag_field"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["More details are available in the ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/magnet-lattice",children:"MagneticLattice documentation"}),"."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'# initialization of tracking method\nmethod = {"global": SecondTM}\n\n# for first order tracking uncomment next line\n# method = {"global": TransferMap}\n\n# we start simulation from the first quadrupole (QI.46.I1) after RF section.\n# you can change stop element (and the start element, as well) \n# START_73_I1 - marker before Dog leg\n# START_96_I1 - marker before Bunch Compresion\nlat_t = MagneticLattice(cell, start=start_sim, stop=None, method=method)\n'})}),"\n",(0,i.jsx)(e.h2,{id:"tracking-1",children:"Tracking"}),"\n",(0,i.jsx)(e.p,{children:"To perform tracking, you need to define the following objects:"}),"\n",(0,i.jsx)(e.h3,{id:"navigator",children:(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/navigator",children:(0,i.jsx)(e.code,{children:"Navigator"})})}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/navigator",children:(0,i.jsx)(e.code,{children:"Navigator"})})," controls how the beam distribution (",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/particle-array",children:(0,i.jsx)(e.code,{children:"ParticleArray"})}),") is propagated through the lattice.",(0,i.jsx)(e.br,{}),"\n","It defines the tracking step size (",(0,i.jsx)(e.code,{children:"unit_step"}),") and where physical processes (e.g. space charge, CSR) are applied."]}),"\n",(0,i.jsx)(e.p,{children:"To add collective effects, use the method:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"navi.add_physics_proc(physics_proc, elem1, elem2)\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"physics_proc"}),": the physics process (e.g. SpaceCharge, CSR, Wake)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"elem1"}),", ",(0,i.jsx)(e.code,{children:"elem2"}),": the range of elements where the process will be applied"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Navigator attributes:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"unit_step = 1 (default): step size [m] for applying physics processes"}),"\n"]}),"\n",(0,i.jsx)(e.admonition,{type:"warning",children:(0,i.jsx)(e.p,{children:"The unit_step is ignored if no physics processes are added (excluding kick-like ones such as BeamTransform).\nIn this case, tracking is done element-by-element."})}),"\n",(0,i.jsxs)(e.h3,{id:"track-function",children:[(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/tracking",children:(0,i.jsx)(e.code,{children:"track()"})})," function"]}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/tracking",children:(0,i.jsx)(e.code,{children:"track()"})})," function propagates a ParticleArray through a MagneticLattice.\nIt also calculates beam Twiss parameters at each step (optional)."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"tws_list, p_array_out = track(lattice, p_array, navi)\n"})}),"\n",(0,i.jsx)(e.p,{children:"Main arguments:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["lattice: ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/magnet-lattice",children:"MagneticLattice"})," object"]}),"\n",(0,i.jsxs)(e.li,{children:["p_array: input ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/particle-array",children:(0,i.jsx)(e.code,{children:"ParticleArray"})})]}),"\n",(0,i.jsxs)(e.li,{children:["navi: ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/navigator",children:(0,i.jsx)(e.code,{children:"Navigator"})})," instance"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Returns:\n\u2022\ttws_list: list of ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/twiss",children:"Twiss"})," objects (empty if calc_tws=False)\n\u2022\tp_array_out: final ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/particle-array",children:(0,i.jsx)(e.code,{children:"ParticleArray"})})," after tracking"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'navi = Navigator(lat_t)\np_array = deepcopy(p_array_init)\nstart = time.time()\ntws_track, p_array = track(lat_t, p_array, navi)\nprint("\\n time exec:", time.time() - start, "sec")\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"    z = 93.40410100084 / 93.40410100084006. Applied: d:  \n     time exec: 11.96444821357727 sec\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'# you can change top_plot argument, for example top_plot=["alpha_x", "alpha_y"]\nplot_opt_func(lat_t, tws_track, top_plot=["E"], fig_name=0, legend=False)\nplt.show()\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"png",src:a(5149).A+"",width:"633",height:"487"})}),"\n",(0,i.jsx)(e.h4,{id:"tracking-with-beam-matching",children:"Tracking with Beam Matching"}),"\n",(0,i.jsxs)(e.p,{children:["To match the beam to the design optics, you can apply an artificial transformation using ",(0,i.jsx)(e.a,{href:"/docs/docu/physics-processes/beamtransform",children:(0,i.jsx)(e.code,{children:"BeamTransform"})})," physics process:"]}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.a,{href:"/docs/docu/physics-processes/beamtransform",children:(0,i.jsx)(e.code,{children:"BeamTransform"})})," process transform the particle distribution to match the specified Twiss parameters."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'tw = Twiss()\ntw.beta_x = 2.36088\ntw.beta_y = 2.824\ntw.alpha_x = 1.2206\ntw.alpha_y = -1.35329\n\nbt = BeamTransform(tws=tw)\n\nnavi = Navigator(lat_t)\n\nnavi.unit_step = 1 # ignored in that case, tracking will performs element by element. \n                   # - there is no PhysicsProc along the lattice, \n                   # BeamTransform is aplied only once\n\nnavi.add_physics_proc(bt, OTRC_55_I1, OTRC_55_I1)\np_array = deepcopy(p_array_init)\nstart = time.time()\ntws_track, p_array = track(lat_t, p_array, navi)\nprint("\\n time exec:", time.time() - start, "sec")\nplot_opt_func(lat_t, tws_track, top_plot=["E"], fig_name=0, legend=False)\nplt.show()\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"    z = 93.40410100084 / 93.40410100084006. Applied: d:  mTransform\n     time exec: 11.477344989776611 sec\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"png",src:a(1714).A+"",width:"633",height:"487"})}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/tracking",children:(0,i.jsx)(e.code,{children:"track()"})})," function returns a list of ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/twiss",children:(0,i.jsx)(e.code,{children:"Twiss"})})," objects (",(0,i.jsx)(e.code,{children:"tws_track"}),") and the final ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/particle-array",children:(0,i.jsx)(e.code,{children:"ParticleArray"})})," (",(0,i.jsx)(e.code,{children:"p_array"}),").",(0,i.jsx)(e.br,{}),"\n","The ",(0,i.jsx)(e.a,{href:"/docs/docu/OCELOT%20fundamentals/twiss",children:(0,i.jsx)(e.code,{children:"Twiss"})})," objects contain key beam properties such as size, position, emittance, and second moments at each step along the lattice."]})}),"\n",(0,i.jsx)(e.p,{children:"You can extract common beam parameters like this:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Beam trajectory (center of mass):"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"x = [tw.x for tw in tws_track]\n"})}),"\n",(0,i.jsx)(e.p,{children:"Or beam size::"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"sigma_x = np.sqrt([tw.xx for tw in tws_track])\n"})}),"\n",(0,i.jsx)(e.p,{children:"of bunch length:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"sigma_tau = np.sqrt([tw.tautau for tw in tws_track])\n"})}),"\n",(0,i.jsxs)(e.p,{children:["More about beam parameter calculations can be found in the ",(0,i.jsx)(e.a,{href:"/docs/docu/functions/get_envelope",children:(0,i.jsx)(e.code,{children:"get_envelope()"})})," function."]}),"\n",(0,i.jsx)(e.h3,{id:"example",children:"Example"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'sigma_x = np.sqrt([tw.xx for tw in tws_track])\ns = [tw.s for tw in tws_track]\n\nplt.plot(s, sigma_x)\nplt.xlabel("s [m]")\nplt.ylabel(r"$\\sigma_x$, [m]")\nplt.show()\n\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"png",src:a(5945).A+"",width:"605",height:"432"})}),"\n",(0,i.jsx)(e.h4,{id:"beam-distribution",children:"Beam distribution"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# the beam head is on left side \nshow_e_beam(p_array, figsize=(8,6))\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"png",src:a(948).A+"",width:"696",height:"547"})}),"\n",(0,i.jsx)(e.h3,{id:"explicit-usage-of-matplotlib-functions",children:"Explicit usage of matplotlib functions"}),"\n",(0,i.jsx)(e.h4,{id:"current-profile",children:"Current profile"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'bins_start, hist_start = get_current(p_array, num_bins=200)\n\nplt.figure(4)\nplt.title("current: end")\nplt.plot(bins_start*1000, hist_start)\nplt.xlabel("s, mm")\nplt.ylabel("I, A")\nplt.grid(True)\nplt.show()\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"png",src:a(6626).A+"",width:"563",height:"453"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'tau = np.array([p.tau for p in p_array])\ndp = np.array([p.p for p in p_array])\nx = np.array([p.x for p in p_array])\ny = np.array([p.y for p in p_array])\n\nax1 = plt.subplot(311)\n# inverse head and teil. The beam head is right side\nax1.plot(-tau*1000, x*1000, \'r.\')\nplt.setp(ax1.get_xticklabels(), visible=False)\nplt.ylabel("x, mm")\nplt.grid(True)\n\nax2 = plt.subplot(312, sharex=ax1)\nax2.plot(-tau*1000, y*1000, \'r.\')\nplt.setp(ax2.get_xticklabels(), visible=False)\nplt.ylabel("y, mm")\nplt.grid(True)\n\nax3 = plt.subplot(313, sharex=ax1)\nax3.plot(-tau*1000, dp, \'r.\')\nplt.ylabel("dE/E")\nplt.xlabel("s, mm")\nplt.grid(True)\nplt.show()\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"png",src:a(7683).A+"",width:"594",height:"432"})})]})}function d(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(h,{...s})}):h(s)}},5149:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/2_tracking_14_0-ae483c8138e6c11b79ca480c864ce1e5.png"},1714:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/2_tracking_16_1-bcc764ceae4687b7cdc4f9be31c307bb.png"},5945:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/2_tracking_18_0-2ff36e3e57568e9856d960b479d3a6f3.png"},948:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/2_tracking_20_0-77a51be0fc0f3087409cc75d736c2283.png"},6626:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/2_tracking_22_0-9aa3eaf0a4d78a1b6841b4b4de06ea5b.png"},7683:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/2_tracking_23_0-8dbefb5f26a586bdf7bbf959d6619055.png"},7157:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/2_tracking_7_0-586c0f14b473552342684c095d0d3e01.png"},8453:(s,e,a)=>{a.d(e,{R:()=>t,x:()=>c});var n=a(6540);const i={},l=n.createContext(i);function t(s){const e=n.useContext(l);return n.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function c(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:t(s.components),n.createElement(l.Provider,{value:e},s.children)}}}]);